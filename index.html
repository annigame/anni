<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anni - Daily Temporal Puzzle</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Helvetica Neue',Arial,sans-serif;background:#000;color:#fff;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;transition:background .3s,color .3s;font-size:16px}
body.light-mode{background:#f5f5f5;color:#000}
.container{max-width:600px;width:100%;padding-bottom:100px}
.theme-toggle{position:fixed;top:20px;right:20px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);border-radius:50%;width:44px;height:44px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:20px;transition:all .3s;z-index:1000}
.theme-toggle:hover{background:rgba(255,255,255,.2)}
body.light-mode .theme-toggle{background:rgba(0,0,0,.05);border:1px solid rgba(0,0,0,.1)}
body.light-mode .theme-toggle:hover{background:rgba(0,0,0,.1)}h1{font-family:'Orbitron',sans-serif;text-align:center;font-size:4em;margin-bottom:5px;font-weight:900;letter-spacing:12px}
.subtitle{text-align:center;color:#888;margin-bottom:15px;font-size:.9em;letter-spacing:3px}
body.light-mode .subtitle{color:#666}
.day-num{text-align:center;color:#666;font-size:.8em;letter-spacing:2px;margin-bottom:40px}
body.light-mode .day-num{color:#888}.intro{background:#0a0a0a;border:1px solid #222;border-radius:4px;padding:40px;line-height:1.8}
body.light-mode .intro{background:#fff;border:1px solid #ddd}
.intro p{margin-bottom:15px;color:#aaa;font-size:1.05em}
body.light-mode .intro p{color:#555}
.intro .cust{color:#fff;font-style:italic;border-left:2px solid #666;padding-left:15px;margin-top:20px;font-size:1.05em}
body.light-mode .intro .cust{color:#000;border-left-color:#999}.btn-start{display:block;margin:25px auto 0;padding:15px 50px;background:#fff;color:#000;border:none;border-radius:4px;font-size:1em;cursor:pointer;font-weight:600;letter-spacing:2px}.btn-start:hover{background:#ddd}.game{display:none}.clues{margin-bottom:40px}.clue{margin-bottom:20px;padding:20px;background:#0a0a0a;border-radius:4px;border-left:2px solid #444;min-height:90px}
body.light-mode .clue{background:#fff;border:1px solid #ddd;border-left:2px solid #999}
.clue.locked{opacity:.25;border-left-color:#222}
body.light-mode .clue.locked{border-left-color:#ccc}
.clue-lbl{font-size:.75em;color:#555;margin-bottom:10px;letter-spacing:1px}
body.light-mode .clue-lbl{color:#888}
.clue-txt{font-size:1em;line-height:1.7;color:#ccc;font-style:italic}
body.light-mode .clue-txt{color:#333}.gsec{margin-bottom:40px}.gleft{text-align:center;font-size:.85em;color:#666;margin-bottom:25px;letter-spacing:1px}.dboxes{display:flex;justify-content:center;gap:10px;margin-bottom:20px}.dbox{width:60px;height:70px;background:#0a0a0a;border:2px solid #222;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:2em;font-weight:300;color:#fff;cursor:pointer;user-select:none}
body.light-mode .dbox{background:#fff;border:2px solid #ddd;color:#000}
.dbox.active{border-color:#fff;background:#111;box-shadow:0 0 10px rgba(255,255,255,.1)}
body.light-mode .dbox.active{border-color:#000;background:#f0f0f0;box-shadow:0 0 10px rgba(0,0,0,.1)}
.dbox.filled{border-color:#555}
body.light-mode .dbox.filled{border-color:#666}
.btns{display:flex;justify-content:center;gap:15px}button{padding:12px 40px;background:#fff;color:#000;border:none;border-radius:4px;font-size:.95em;cursor:pointer;font-weight:500;letter-spacing:1px}button:hover{background:#ddd}button.sec{background:transparent;color:#fff;border:1px solid #444}button.sec:hover{border-color:#888;background:#111}.hist{margin-top:30px}.gitem{padding:15px;margin-bottom:10px;background:#0a0a0a;border-radius:4px;display:flex;justify-content:space-between;border-left:3px solid #222}
body.light-mode .gitem{background:#fff;border:1px solid #ddd;border-left:3px solid #ccc}
.gitem.low{border-left-color:#4a9eff}
.gitem.high{border-left-color:#ff6b6b}
.gitem.win{border-left-color:#51cf66;background:#0a1f0a}
body.light-mode .gitem.win{background:#e8f5e9}
.gyear{font-size:1.4em;font-weight:300}
.fb{font-size:.95em;color:#777}
body.light-mode .fb{color:#666}
.fb.win{color:#51cf66}
body.light-mode .fb.win{color:#2e7d32}.over{text-align:center;padding:40px;background:#0a0a0a;border-radius:4px;margin-top:30px;border:1px solid #222}
body.light-mode .over{background:#fff;border:1px solid #ddd}
.over h2{margin-bottom:20px;font-weight:300;font-size:1.9em;letter-spacing:3px}
.ans{font-size:3.2em;margin:20px 0;font-weight:300;font-family:'Orbitron',sans-serif;letter-spacing:5px}
.rmsg{color:#888;margin-bottom:10px;font-style:italic;font-size:1.05em}
body.light-mode .rmsg{color:#666}
.cclose{color:#888;margin-top:15px;font-size:.95em;line-height:1.6}
body.light-mode .cclose{color:#666}
.st{margin-top:20px;background:#111;padding:15px;border-radius:4px;font-family:monospace;white-space:pre;font-size:.9em;display:none}
body.light-mode .st{background:#f0f0f0;color:#000}
.btn-share{margin-top:15px}
#hiddenInput{position:absolute;left:-9999px;width:1px;height:1px;opacity:0}
.streak{margin-top:40px;text-align:center}.shead{font-size:.8em;color:#666;letter-spacing:2px;margin-bottom:10px}
body.light-mode .shead{color:#888}
.snum{font-size:2.5em;font-weight:300;margin-bottom:10px;font-family:'Orbitron',sans-serif}
.sbar{width:100%;height:8px;background:#222;border-radius:4px;overflow:hidden;margin-top:10px}
body.light-mode .sbar{background:#ddd}
.sfill{height:100%;background:linear-gradient(90deg,#4a9eff,#51cf66);transition:width .3s}
</style>
</head>
<body>
<div class="theme-toggle" onclick="toggleTheme()">ðŸŒ™</div>
<div class="container">
<div id="intro" class="intro">
<h1>ANNI</h1>
<div class="subtitle">DAILY TEMPORAL PUZZLE</div>
<div class="day-num" id="dn-intro">ANNI #1</div>
<p>You are lost in time.</p>
<p>A temporal navigator has left you clues to find your way back. Each day presents a different moment in historyâ€”your task is to identify the exact year.</p>
<p>You have six attempts. After your second guess, you will unlock a second clue. After your fourth guess, a third clue will reveal itself.</p>
<p>Are you ready to begin your journey through time?</p>
<div class="cust">"Not all who wander are lost, but you certainly are. Let me help you find your way home."</div>
<button class="btn-start" onclick="start()">BEGIN NAVIGATION</button>
<div class="streak">
<div class="shead">CURRENT STREAK</div>
<div class="snum" id="sn">0</div>
<div class="sbar"><div class="sfill" id="sf"></div></div>
</div>
</div>
<div id="game" class="game">
<h1>ANNI</h1>
<div class="subtitle">DAILY TEMPORAL PUZZLE</div>
<div class="day-num" id="dn">ANNI #1</div>
<div class="clues">
<div id="c1" class="clue locked">
<div class="clue-lbl">CLUE 1</div>
<div id="c1t" class="clue-txt">Locked...</div>
</div>
<div id="c2" class="clue locked">
<div class="clue-lbl">CLUE 2</div>
<div id="c2t" class="clue-txt">Locked...</div>
</div>
<div id="c3" class="clue locked">
<div class="clue-lbl">CLUE 3</div>
<div id="c3t" class="clue-txt">Locked...</div>
</div>
</div>
<div id="gsec" class="gsec">
<div class="gleft" id="gl">6 ATTEMPTS REMAINING</div>
<div class="dboxes">
<div class="dbox"></div>
<div class="dbox"></div>
<div class="dbox"></div>
<div class="dbox"></div>
</div>
<input type="number" inputmode="numeric" pattern="[0-9]*" id="hiddenInput" autocomplete="off">
<div class="btns">
<button onclick="sub()">SUBMIT</button>
<button class="sec" onclick="clr()">CLEAR</button>
</div>
<div class="hist" id="hist"></div>
</div>
<div id="over" class="over" style="display:none">
<h2 id="ot">NAVIGATION SUCCESSFUL</h2>
<div class="ans" id="oa">1969</div>
<div class="rmsg" id="om">Temporal coordinates identified in 3 attempts</div>
<div class="cclose" id="oc">"You have proven capable. The path forward through time opens before you. But many moments remain between you and home."</div>
<div class="st" id="st"></div>
<button class="btn-share" onclick="shr()">SHARE RESULTS</button>
</div>
<div class="streak">
<div class="shead">CURRENT STREAK</div>
<div class="snum" id="sn">0</div>
<div class="sbar"><div class="sfill" id="sf"></div></div>
</div>
</div>
</div>
<script>
const D=[
{y:1066,c:["Normans crossed Channel while Harold marched from Stamford to Hastings.","Harold's eye met an arrow and William claimed divine right.","Westminster Abbey consecrated just days before Edward the Confessor died."]},
{y:1215,c:["John signed at Runnymede while crusaders conquered Languedoc in Albigensian campaign.","Magna Carta forced king's seal to parchment limiting royal power.","Fourth Lateran Council defined transubstantiation doctrine for Christendom."]},
{y:1347,c:["Black Death arrived on Genoese ships fleeing Crimean siege.","Plague killed a third of Europe as fleas spread Yersinia.","Cola di Rienzo briefly restored Roman Republic before Pope crushed it."]},
{y:1453,c:["Constantinople's walls fell while cannons changed warfare forever.","Mehmed breached Theodosian walls ending thousand-year empire.","Hundred Years War ended at Castillon with English expulsion from France."]},
{y:1492,c:["Columbus landed while Granada fell and Jews were expelled.","Isabella backed voyage to India that reached Caribbean islands instead.","Lorenzo de Medici died as Florence's golden age ended abruptly."]},
{y:1517,c:["Luther nailed theses while Ottomans advanced toward Vienna.","Ninety-five theses challenged indulgences beginning Protestant schism.","Ottoman Empire conquered Egypt ending Mamluk Sultanate's long rule."]},
{y:1588,c:["Philip's Armada scattered in Channel storms and English cannons.","Drake's fire ships broke Calais formation as gales wrecked fleet.","Montaigne published final edition of Essays defining new literary form."]},
{y:1618,c:["Defenestration sparked conflagration that consumed Europe for decades.","Prague's thrown officials survived while Thirty Years War began.","Raleigh executed by James I after failed expedition to El Dorado."]},
{y:1648,c:["Westphalia treaties ended war while Fronde revolted against Mazarin.","Thirty years ended at MÃ¼nster establishing sovereign state system.","English Civil War reached climax as Pride's Purge purified Parliament."]},
{y:1688,c:["William landed while James fled and Parliament declared throne vacant.","Glorious Revolution transferred crown without bloodshed in England.","Lloyd's of London coffeehouse became world's insurance market center."]},
{y:1776,c:["Congress declared independence while Smith published economic treatise.","Thirteen colonies severed ties in Philadelphia declaring natural rights.","Cook began third Pacific voyage seeking Northwest Passage unsuccessfully."]},
{y:1789,c:["Bastille fell while Assembly declared rights and march fetched king.","Estates-General transformed into Assembly abolishing feudal privileges.","Washington inaugurated as first president under new Constitution."]},
{y:1815,c:["Wellington defeated Napoleon at Waterloo ending revolutionary era.","Hundred Days ended at Belgian field while Congress redrew Europe.","Mount Tambora erupted causing year without summer across globe."]},
{y:1848,c:["Marx published manifesto while revolutions swept across Europe.","Spring of Nations challenged monarchies from Paris to Vienna.","California Gold Rush began drawing hundreds of thousands westward."]},
{y:1865,c:["Lincoln fell at Ford's while Sherman's march had burned Georgia.","Thirteenth Amendment abolished slavery after Appomattox surrender.","Lewis Carroll published Alice's Adventures in Wonderland for children."]},
{y:1914,c:["Archduke's assassination in Sarajevo triggered mobilization cascades.","August guns began firing as alliances pulled empires into war.","Panama Canal opened connecting Atlantic and Pacific commercial routes."]},
{y:1917,c:["Tsar fell while Lenin returned and Bolsheviks seized Winter Palace.","October Revolution established Soviet state during European war.","Balfour Declaration promised Jewish homeland in Ottoman Palestine."]},
{y:1929,c:["Black Tuesday crashed while Hoover proclaimed prosperity's corner.","Wall Street collapsed triggering global depression and dustbowls.","Vatican City became independent sovereign state under Lateran Treaty."]},
{y:1933,c:["Roosevelt promised New Deal while Hitler gained Enabling Act.","Reichstag fire preceded emergency powers consolidating Nazi control.","Hitler's rise to power began Germany's descent into dictatorship."]},
{y:1939,c:["Molotov-Ribbentrop divided Poland while Blitzkrieg rolled through Warsaw.","Wehrmacht invaded Poland triggering British and French declarations.","Gone with the Wind premiered becoming highest-grossing film ever made."]},
{y:1941,c:["Barbarossa launched while Pearl Harbor pulled America into war.","Hitler invaded Russia as Japan attacked Pacific destroying isolationism.","Citizen Kane premiered revolutionizing cinema with deep focus cinematography."]},
{y:1945,c:["Mushroom clouds rose twice while Auschwitz's gates opened to horror.","Hiroshima and Nagasaki ended Pacific war after European victory.","United Nations charter signed in San Francisco establishing new order."]},
{y:1947,c:["India partitioned while Marshall Plan rebuilt and Truman declared doctrine.","Midnight's partition created Pakistan as millions migrated violently.","Dead Sea Scrolls discovered in Qumran caves revealing ancient texts."]},
{y:1948,c:["Israel declared statehood while Berlin airlift defied Soviet blockade.","British Mandate ended as Arab-Israeli war began immediately.","Gandhi assassinated by Hindu nationalist ending nonviolent leader's life."]},
{y:1949,c:["Mao proclaimed republic while NATO formed and Soviets tested bomb.","Communists won civil war as Nationalists fled to Taiwan.","Orwell published 1984 depicting totalitarian surveillance dystopia."]},
{y:1950,c:["Kim's army crossed parallel while McCarthy waved lists in Wheeling.","Korean invasion triggered UN response and MacArthur's Inchon landing.","Brinks robbery in Boston netted thieves 2.7 million in cash."]},
{y:1953,c:["Stalin died while Rosenbergs executed and DNA's helix discovered.","Armistice froze Korea while Khrushchev began struggle for succession.","Hillary and Tenzing summited Everest conquering world's highest peak."]},
{y:1954,c:["Dien Bien Phu fell while Brown v Board declared segregation unconstitutional.","French Indochina collapsed as Vietnam divided at Geneva Conference.","Bannister broke four-minute mile barrier thought physically impossible."]},
{y:1956,c:["Soviets crushed Hungary while Suez Crisis humiliated Britain and France.","Khrushchev's secret speech denounced Stalin beginning Thaw period.","Elvis Presley appeared on Ed Sullivan show shocking conservative America."]},
{y:1957,c:["Sputnik orbited while Little Rock Nine integrated Central High.","Soviet satellite shocked America beginning space race rivalry.","Treaty of Rome established European Economic Community foundation."]},
{y:1961,c:["Bay of Pigs failed while Wall rose dividing Berlin overnight.","Kennedy botched invasion as Khrushchev backed concrete barrier.","Yuri Gagarin became first human in space orbiting Earth once."]},
{y:1962,c:["Missiles in Cuba brought world to brink of nuclear war.","Algeria gained independence ending 132 years of French colonial rule.","Vatican II opened modernizing Catholic Church for contemporary world."]},
{y:1963,c:["Kennedy shot in Dallas while March on Washington heard Dream.","Profumo affair toppled Macmillan as sex scandal rocked Britain.","Valentina Tereshkova became first woman to orbit Earth in space."]},
{y:1965,c:["Marines landed at Da Nang as Malcolm X was shot.","Johnson escalated Vietnam while Watts burned and Selma marched.","Singapore expelled from Malaysia becoming independent city-state nation."]},
{y:1968,c:["Tet Offensive shocked America while King and Kennedy were shot.","Prague Spring crushed while Chicago convention descended into violence.","Assassinations, war protests, and upheaval defined this turbulent year."]},
{y:1969,c:["Armstrong stepped on moon while Woodstock gathered and Manson killed.","Stonewall riots sparked gay liberation movement in Greenwich Village.","Concorde made first supersonic test flight above French countryside."]},
{y:1972,c:["Nixon opened China while Watergate burglars were caught.","Munich Olympics massacred as dÃ©tente thawed Cold War.","Bloody Sunday in Derry killed 14 escalating Northern Ireland Troubles."]},
{y:1973,c:["Yom Kippur surprised Israel while OPEC embargoed oil.","Roe v Wade legalized abortion sparking decades of American culture war.","Pinochet's coup overthrew Allende as Chile's democracy died violently."]},
{y:1975,c:["Saigon fell while Khmer Rouge emptied Phnom Penh.","Franco died ending decades of Spanish dictatorship and repression.","Microsoft founded by Gates and Allen in Albuquerque garage."]},
{y:1979,c:["Thatcher won while Tehran seized hostages and Soviets entered Afghanistan.","Sony Walkman launched revolutionizing how humans consumed portable music.","Pope John Paul II visited Poland inspiring Solidarity movement seeds."]},
{y:1980,c:["Lennon died on Dakota steps while Solidarity struck GdaÅ„sk shipyards.","Reagan won as Iraq invaded Iran beginning eight years of war.","Mount St Helens erupted in Washington killing 57 and blanketing region."]},
{y:1986,c:["Challenger exploded on ascent while Chernobyl's core melted down.","Marcos fled Manila as Aquino's People Power triumphed peacefully.","Iran-Contra scandal exposed as Reagan secretly armed Nicaraguan rebels."]},
{y:1989,c:["Tiananmen's tanks crushed hope while Rushdie's Verses earned a fatwa.","Exxon Valdez spilled crude devastating Alaska's pristine Prince William Sound.","Tim Berners-Lee proposed World Wide Web at CERN laboratory."]},
{y:1990,c:["Mandela walked free as two Germanys became one and Iraq took Kuwait.","Hubble Space Telescope launched revealing universe in unprecedented clarity.","Tim Berners-Lee created first web browser and server at CERN."]},
{y:1991,c:["Desert Storm liberated Kuwait as Yugoslavia fragmented violently.","India's economic liberalization ended License Raj opening markets globally.","Rajiv Gandhi assassinated by Tamil Tiger suicide bomber near Madras."]},
{y:1994,c:["Mandela won while Rwanda's hundred days killed 800,000 Tutsis.","Channel Tunnel opened connecting Britain and France beneath the sea.","Amazon founded by Bezos in Seattle garage as online bookstore."]},
{y:1997,c:["Diana died in Parisian tunnel as Hong Kong's lease expired at midnight.","Dolly the sheep proved cloning possible while Blair landslided.","Deep Blue computer defeated Kasparov proving machine intelligence triumph."]},
{y:2001,c:["Wikipedia launched as towers fell and iPods launched and anthrax mailed.","Bush took office after Supreme Court ended Florida recount controversy.","China joined WTO integrating world's largest population into global trade."]},
{y:2003,c:["Shock and awe lit Baghdad as SARS spread and Columbia disintegrated.","Human Genome Project completed mapping all human genetic code.","Rose Revolution toppled Shevardnadze bringing Saakashvili to power in Georgia."]},
{y:2004,c:["Boxing Day's quake triggered waves killing 230,000 across the ocean.","Facebook launched from Harvard dorm as Abu Ghraib photos leaked.","Madrid train bombings killed 193 three days before Spanish elections."]},
{y:2007,c:["iPhone launched as subprime mortgages began unraveling globally.","Virginia Tech massacre shocked as Bhutto returned then died.","Kindle released transforming publishing as e-books became mainstream reality."]},
{y:2008,c:["Lehman collapsed triggering panic as Obama made history in November.","The financial crisis metastasized from subprime to global catastrophe.","Beijing hosted Summer Olympics showcasing China's rise as superpower."]},
{y:2011,c:["Bouazizi's self-immolation sparked uprisings from Tunisia to Syria.","Bin Laden died in Abbottabad while Fukushima melted after tsunami.","South Sudan gained independence becoming world's newest nation state."]},
{y:2014,c:["Crimea was annexed as Ebola raged and ISIS proclaimed its caliphate.","Malaysia Airlines Flight 370 vanished mysteriously over Indian Ocean.","Scottish independence referendum failed as Catalonia's symbolically succeeded."]},
{y:2016,c:["Brexit shocked elites while Trump won and Aleppo fell.","Pokemon Go launched bringing augmented reality gaming to global masses.","Zika virus spread rapidly through Americas linked to birth defects."]},
{y:2020,c:["Kobe died in fog while bushfires raged and Floyd couldn't breathe.","Trump impeached then acquitted as senators split along partisan lines.","Murder hornets invaded while TikTok danced and sourdough bread trended."]},
{y:2022,c:["Putin's tanks rolled toward Kyiv as Europe united against invasion.","Queen Elizabeth II died ending Britain's second Elizabethan age.","Elon Musk acquired Twitter for 44 billion sparking platform chaos."]}
];
let cur,gs=[],inp='';
function getDay(){const e=new Date('2026-02-12'),t=new Date();t.setHours(0,0,0,0);return Math.floor((t-e)/864e5)+1}
function getPuz(){return D[getDay()%D.length]}
function loadSt(){try{const s=localStorage.getItem('anniState');if(!s)return null;const d=JSON.parse(s);return d.day===getDay()?d:null}catch(e){return null}}
function saveSt(g,w,l){try{localStorage.setItem('anniState',JSON.stringify({day:getDay(),gs:g,w:w,l:l}))}catch(e){}}
function loadStr(){try{const s=localStorage.getItem('anniStreak');return s?JSON.parse(s):{c:0,l:0}}catch(e){return{c:0,l:0}}}
function saveStr(s){try{localStorage.setItem('anniStreak',JSON.stringify(s))}catch(e){}}
function updStr(w){const s=loadStr(),d=getDay();if(w){if(d===s.l+1||s.l===0){s.c++;s.l=d}else if(d>s.l+1){s.c=1;s.l=d}}else{if(d>s.l+1){s.c=0;s.l=0}}saveStr(s);dispStr()}
function dispStr(){const s=loadStr();document.getElementById('sn').textContent=s.c;document.getElementById('sf').style.width=Math.min(s.c/30*100,100)+'%'}
function toggleTheme(){document.body.classList.toggle('light-mode');const isLight=document.body.classList.contains('light-mode');document.querySelector('.theme-toggle').textContent=isLight?'â˜€ï¸':'ðŸŒ™';try{localStorage.setItem('anniTheme',isLight?'light':'dark')}catch(e){}}
function loadTheme(){try{const theme=localStorage.getItem('anniTheme');if(theme==='light'){document.body.classList.add('light-mode');document.querySelector('.theme-toggle').textContent='â˜€ï¸'}}catch(e){}}
function focusInput(){const input=document.getElementById('hiddenInput');if(input){input.focus({preventScroll:true})}}
function start(){const st=loadSt();if(st&&(st.w||st.l)){showDone(st);return}document.getElementById('intro').style.display='none';document.getElementById('game').style.display='block';document.getElementById('dn').textContent='ANNI #'+getDay();init();setTimeout(focusInput,100)}
function init(){cur=getPuz();const st=loadSt();if(st&&!st.w&&!st.l){gs=st.gs;gs.forEach(g=>addH(g,1));if(gs.length>=2){document.getElementById('c2').classList.remove('locked');document.getElementById('c2t').textContent=cur.c[1]}if(gs.length>=4){document.getElementById('c3').classList.remove('locked');document.getElementById('c3t').textContent=cur.c[2]}}else{gs=[]}inp='';document.getElementById('hist').innerHTML='';document.getElementById('over').style.display='none';document.getElementById('gsec').style.display='block';document.getElementById('c1').classList.remove('locked');if(gs.length<2)document.getElementById('c2').classList.add('locked');if(gs.length<4)document.getElementById('c3').classList.add('locked');document.getElementById('c1t').textContent=cur.c[0];if(gs.length<2)document.getElementById('c2t').textContent='Locked...';if(gs.length<4)document.getElementById('c3t').textContent='Locked...';upd();updL();document.getElementById('dn').textContent='ANNI #'+getDay();dispStr()}
function showDone(st){document.getElementById('intro').style.display='none';document.getElementById('game').style.display='block';cur=getPuz();gs=st.gs;gs.forEach(g=>addH(g,1));document.getElementById('c1').classList.remove('locked');document.getElementById('c2').classList.remove('locked');document.getElementById('c3').classList.remove('locked');document.getElementById('c1t').textContent=cur.c[0];document.getElementById('c2t').textContent=cur.c[1];document.getElementById('c3t').textContent=cur.c[2];fin(st.w,1);document.getElementById('dn').textContent='ANNI #'+getDay();dispStr()}
function upd(){const b=document.querySelectorAll('.dbox');b.forEach((x,i)=>{x.textContent=inp[i]||'';x.classList.remove('active','filled');if(i===inp.length&&inp.length<4)x.classList.add('active');else if(i<inp.length)x.classList.add('filled')})}
function clr(){inp='';upd();const h=document.getElementById('hiddenInput');if(h)h.value='';focusInput()}
function sub(){if(inp.length!==4)return;const g=parseInt(inp);gs.push(g);inp='';upd();const h=document.getElementById('hiddenInput');if(h)h.value='';if(gs.length>=2){document.getElementById('c2').classList.remove('locked');document.getElementById('c2t').textContent=cur.c[1]}if(gs.length>=4){document.getElementById('c3').classList.remove('locked');document.getElementById('c3t').textContent=cur.c[2]}addH(g,0);updL();if(g===cur.y){saveSt(gs,1,0);updStr(1);fin(1,0)}else if(gs.length>=6){saveSt(gs,0,1);updStr(0);fin(0,0)}focusInput()}
function addH(g,r){const h=document.getElementById('hist'),d=document.createElement('div');d.className='gitem';let f='',a='';if(g===cur.y){d.classList.add('win');f='COORDINATES CONFIRMED'}else if(g<cur.y){d.classList.add('low');a='â†‘';f='FORWARD IN TIME'}else{d.classList.add('high');a='â†“';f='BACKWARD IN TIME'}d.innerHTML=`<span class="gyear">${g}</span><span class="fb ${g===cur.y?'win':''}">${a} ${f}</span>`;r?h.appendChild(d):h.insertBefore(d,h.firstChild)}
function updL(){const l=6-gs.length;document.getElementById('gl').textContent=`${l} ATTEMPT${l!==1?'S':''} REMAINING`}
function fin(w,r){document.getElementById('gsec').style.display='none';document.getElementById('over').style.display='block';document.getElementById('c2').classList.remove('locked');document.getElementById('c3').classList.remove('locked');document.getElementById('c2t').textContent=cur.c[1];document.getElementById('c3t').textContent=cur.c[2];if(w){document.getElementById('ot').textContent='NAVIGATION SUCCESSFUL';document.getElementById('oa').textContent=cur.y;document.getElementById('om').textContent=`Temporal coordinates identified in ${gs.length} attempt${gs.length!==1?'s':''}`;document.getElementById('oc').textContent='"You have proven capable. The path forward through time opens before you. But many moments remain between you and home."'}else{document.getElementById('ot').textContent='NAVIGATION FAILED';document.getElementById('oa').textContent=cur.y;document.getElementById('om').textContent='Temporal coordinates lost';document.getElementById('oc').textContent='"You remain trapped in this moment. Time flows around you, but you cannot move with it. Perhaps the next era will prove more yielding."'}if(!r)genSh(w)}
function genSh(w){let t=`Anni #${getDay()} ${w?gs.length:'X'}/6\n\n`;gs.forEach(g=>{t+=g===cur.y?'ðŸŸ©':g<cur.y?'ðŸ”µ':'ðŸ”´'});document.getElementById('st').textContent=t;document.getElementById('st').style.display='block'}
function shr(){navigator.clipboard.writeText(document.getElementById('st').textContent).then(()=>{const b=document.querySelector('.btn-share'),o=b.textContent;b.textContent='COPIED!';setTimeout(()=>b.textContent=o,2e3)})}
document.addEventListener('keydown',e=>{if(document.getElementById('gsec').style.display==='none')return;if(e.key>='0'&&e.key<='9'&&inp.length<4){inp+=e.key;upd()}else if(e.key==='Backspace'){inp=inp.slice(0,-1);upd()}else if(e.key==='Enter'&&inp.length===4)sub();else if(e.key==='Escape')clr()});
window.onload=()=>{loadTheme();const st=loadSt();const dayNum=getDay();if(document.getElementById('dn-intro'))document.getElementById('dn-intro').textContent='ANNI #'+dayNum;if(st&&(st.w||st.l)){showDone(st)}else{dispStr();document.getElementById('dn').textContent='ANNI #'+dayNum}const hiddenInput=document.getElementById('hiddenInput');if(hiddenInput){let isProcessing=false;hiddenInput.addEventListener('input',e=>{if(isProcessing)return;isProcessing=true;const raw=e.target.value.replace(/\D/g,'');const newDigits=raw.slice(inp.length);if(newDigits.length>0&&inp.length<4){inp=(inp+newDigits).slice(0,4);upd()}setTimeout(()=>{e.target.value=inp;isProcessing=false},0)});hiddenInput.addEventListener('keydown',e=>{if(e.key==='Enter'&&inp.length===4){e.preventDefault();sub()}else if(e.key==='Backspace'){e.preventDefault();if(inp.length>0){inp=inp.slice(0,-1);upd();setTimeout(()=>e.target.value=inp,0)}}else if(e.key==='Escape'){e.preventDefault();clr();setTimeout(()=>e.target.value='',0)}});document.querySelectorAll('.dbox').forEach(box=>{box.addEventListener('click',()=>{focusInput();setTimeout(()=>hiddenInput.value=inp,0)});box.addEventListener('touchstart',e=>{e.preventDefault();focusInput();setTimeout(()=>hiddenInput.value=inp,0)},{passive:false})})}};
</script>
</body>
</html>
